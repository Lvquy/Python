<?xml version="1.0" encoding="utf-8"?>
<odoo>
<template id="report_saleorder_document">
    <t > <!---  t-call="report.external_layout" Thêm dòng này để gọi thông tin cty vào đầu và cuối báo cáo-->
        <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})" />
        <div class="page">
		<span> <center><img src="/sale/static/img/logo.png" width="100%" height="auto"></img></center> </span>	
		<h2><center> ĐƠN HÀNG MỚI</center></h2>          
              
            <!-- Nhãn filename, chú ý chỉ số width chỉ có tác dụng với kiểu pdf, không có tác dụng hiển thị đối với kiểu html -->
            <t t-set="display_discount" t-value="any([l.discount for l in doc.order_line])"/>		
            <t t-foreach="doc.order_lines_layouted()" t-as="page">
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <tr>
							<th width="20"> <center><p>STT</p><p>(...)</p></center></th>
                            <th width="150"><center><p>KHÁCH HÀNG</p>
                              <p>(...)</p></center></th>
                            <th width="60"><center><p>MSĐH</p>
                              <p>(...)</p></center></th>
                            <th><center><p>TÊN SP KHÁCH</p>
                              <p>(...)</p></center></th>
                            <th><center><p>TÊN SẢN PHẨM LDS</p>
                              <p>(...)</p></center></th>
							<th width="140"><center><p>QUY CÁCH/ MÀU</p>
							  <p>(...)</p></center></th>
							<th width="30"><center><p>SL(CÁI)</p>
							  <p>(...)</p></center></th>
							<th><center><p>NGÀY GIAO</p>
							  <p>(...)</p></center></th>
                        </tr>
                        </tr>
                   </thead>
                   <tbody class="sale_tbody">
                        <t t-foreach="page" t-as="layout_category">
                            <!-- dữ liệu trong bảng -->
							<t t-set="i" t-value="1"/> <!--khởi tạo biến i là số thứ tự-->
							<t t-set="k" t-value="0"/> <!--khởi tạo biến tổng số lượng ban đầu = 0 -->
                            <t t-foreach="layout_category['lines']" t-as="l">
                                <tr align="center">
                                    <td>
									<t t-esc="i"/>
									<t t-set="i" t-value="i+1"/>								
									</td>
                                    <td><span t-field="doc.partner_id"/></td>
                                    <td>
                                        <span t-field="doc.name"/> 
                                    </td>
                                    <td>
                                        <span t-field="l.name"/>
                                    </td>
                                    <td>
                                        <span t-field="l.product_id"/>
                                    </td>
									<td>...</td>
									<td>
										<span t-field="l.product_uom_qty"/>
									</td>
								
                                 <td  t-att-rowspan="len(layout_category['lines'])"> <!---len(layout_category['lines'])để xác định độ dài dòng đơn hàng-->
										
										<span t-if="i==2">
										<span t-field="doc.confirmation_date"/>
										</span>
										
								</td>
                                </tr>
								<t t-set="k" t-value="k+l.product_uom_qty"/>
                            </t>

							<td colspan="6" align="center"><strong> Tổng số lượng:   </strong></td>
						<!---0f là chỉ số phần thập phân-->
							<td align="center"> <strong><t t-esc="'{0:,.0f}'.format(int(k))" /> </strong></td>
					</t>					
                    </tbody>
                </table>
				<hr/>
				<span> Ghi chú: </span> <span style="position:relative;left:700px"> Người lập biểu(.../.../2017)</span>

                <t t-if="page_index &lt; page_size - 1" groups="sale.group_sale_layout">
                    <p style="page-break-before:always;"> </p>
                </t>
            </t>
            <div class="oe_structure"/>
        </div>
    </t>
</template>


<template id="report_saleorder">
    <t t-call="report.html_container">
        <t t-foreach="docs" t-as="doc">
            <t t-call="sale.report_saleorder_document" t-lang="doc.partner_id.lang"/>
        </t>
    </t>
</template>
</odoo>
